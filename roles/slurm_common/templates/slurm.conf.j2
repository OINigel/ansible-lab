# ============================
#  Slurm Configuration
# ============================

ClusterName={{ slurm_cluster_name }}
SlurmctldHost={{ slurm_controller_hostname }}
SlurmctldHost={{ slurm_backup_controller_hostname }} 

SlurmUser=slurm
SlurmdUser=slurm
StateSaveLocation=/var/spool/slurm
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmdPidFile=/var/run/slurmd.pid
SlurmctldPort=6817
SlurmdPort=6818
AuthType=auth/munge
ReturnToService=2
SchedulerType=sched/backfill
SlurmctldTimeout=300
SlurmdTimeout=300
ProctrackType=proctrack/cgroup
TaskPlugin=task/none

{% for node in groups['compute'] %}
NodeName={{ node }} \
  CPUs={{ hostvars[node].ansible_facts.processor_vcpus | default(4) }} \
  RealMemory={{ hostvars[node].ansible_facts.memtotal_mb | default(1024) }} \
  State=UNKNOWN
{% endfor %}

PartitionName=debug Nodes={{ groups['compute'] | default([]) | join(',') }} Default=NO  MaxTime=INFINITE State=UP
PartitionName=Main  Nodes={{ groups['compute'] | default([]) | join(',') }} Default=YES MaxTime=INFINITE State=UP
